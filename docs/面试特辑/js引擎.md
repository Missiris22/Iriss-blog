---
title: js引擎
date: '2022-09-27'
categories:
    - 面试特辑
---

参考

- [前端开发JavaScript原理：引擎基础](https://zhuanlan.zhihu.com/p/84225436)

- [JS编译器都做了啥](https://juejin.cn/post/6844903751090700295#heading-11)

知名引擎：

chrome V8引擎
apple javascriptCore

## js引擎是什么？

### js引擎是一个程序虚拟机

**js引擎是一个专门处理js脚本的程序虚拟机，一般会附带在网页浏览器中。**

**js引擎能够“读懂”一段js代码，并且准确给出代码运行结果**

> 比如 `const a = 1 + 2`，js将解释这行代码，并给 a 赋值 3.

#### 什么是虚拟机？

一种特殊的软件，可以在计算机平台和客户终端之间创建一种环境。终端用户基于软件创造的环境操作软件。

**虚拟机的分类**

- 系统虚拟机：提供一个可以运行完整操作系统的完整系统平台

- 程序虚拟机：运行单个计算机程序设计，这意谓它支持单个进程

### 编译器 & 解释器

**无法完全定义 js引擎 是 编译器 还是 解释器**

- **编译器：将源代码解释成另外一种代码（机器码 / 字节码）**

    编译型语言：程序在执行之前经过编译，将程序编译成机器语言的文件（exe文件）。运行时不需要编译，直接运行编译文件
        - 执行效率高
        - 跨平台性差

- **解释器：直接解析并将代码运行输出结果**

    解释器语言：在程序运行时用解释器编译成机器语言，一边编译，一边执行（没有exe文件）
        - 执行效率差
        - 跨平台性高

但是，现在很难去界定说，JavaScript引擎到底算是解释器还是编译器，因为，比如像V8（Chrome的JS引擎），它其实为了提高 JS的运行性能，在运行之前会先将JS编译为本地的机器码（native machine code），然后再去执行机器码（这样速度就快很多），相信大家对JIT（Just In Time Compilation）一定不陌生吧。

> 附加知识： **JIM 编译器**

JIT（just-in-time compilation）指计算机领域里，即时编译也被成为动态翻译，是一种通过在运行时将字节码翻译为机器码，从而改善字节码编译语言性能的技术。

### js引擎的组成

1. 编译器

主要工作是将源代码编译成抽象语法树，然后在某些引擎中还包含将抽象语法树转换成字节码。

2. 解释器

在某些引擎中，解释器主要是接受字节码，解释执行这个字节码，然后也依赖来及回收机制等。

3. JIT工具

一个能够JIT的工具，将字节码或者抽象语法树转换成本地代码，当然它也需要依赖牢记

4. 垃圾回收和分析工具

它们负责垃圾回收和收集引擎中的信息，帮助改善引擎的性能和功效。

> 附加知识： **JIT 技术**

推动JavaScript运行速度提高的另一大利器就是JIT技术，其作用是解决解释性语言的性能问题，主要思想是当解释器将源代码解释成内部表示的时候（类似于java字节码），JavaScript的执行环境不仅是解释这些内部表示，而且将其中一些字节码（使用率高的部分）转成本地代码（汇编代码），这样就可以被CPU直接执行，而不是解释执行，从而提高性能。

## js 引擎和 ECMAScript 的关系

js引擎是一段程序，js代码也是一段程序。ES 就是 js引擎 解析 js代码 的规则。

标准的 js引擎（V8） 会按照这一套标准执行，但是也存在不标准的引擎，比如 IE的js引擎。

## V8引擎是如何编译的？

## 引擎编译的顺序？
